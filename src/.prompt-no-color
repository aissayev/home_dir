function parse_git_info {
	branch=`parse_git_branch`;
	if [ -n "$branch" ];
	then
		status=`parse_git_status`;
		if [ -n "$status" ];
		then
			echo ":[$branch:$status]";
		else
			echo ":[$branch]";
		fi
	fi
}

function parse_git_branch {
	branch=`git branch --no-color 2> /dev/null | grep '\* ' | tr -d '* '`;
	if [ -n "$branch" ];
	then
		echo "$branch";
	fi
}

function parse_git_status {
	status=`git status 2> /dev/null`;
	accumulated_status="";
	if [[ $status =~ "Your branch is ahead" ]] || [[ `git show --oneline origin/master 2> /dev/null | head -1` != `git show --oneline 2> /dev/null | head -1` ]];
	then
		accumulated_status=$accumulated_status"c";
	fi
	if [[ $status =~ "Changes to be committed:" ]];
	then
		accumulated_status=$accumulated_status"s";
	fi
	if [[ $status =~ "Unmerged paths:" ]];
	then
		accumulated_status=$accumulated_status"m";
	fi
	if [[ $status =~ "Changes not staged for commit:" ]];
	then
		accumulated_status=$accumulated_status"u";
	fi
	if [[ $status =~ "Untracked files:" ]];
	then
		accumulated_status=$accumulated_status"n";
	fi
	if [ -n "$accumulated_status" ];
	then
		echo $accumulated_status;
	fi
}

export PS1='\u@\h:(\w)$(parse_git_info)\n\$ ';
